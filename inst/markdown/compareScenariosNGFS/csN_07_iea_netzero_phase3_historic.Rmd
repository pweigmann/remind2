# IEA Net-Zero Comparison with NGFS Phase 3 and historical data {-}

# Socio-Economics

## Carbon Price
```{r}
plot_default(ivar="Price|Carbon", ititle="Carbon Price in 2030 [US$2010/t CO2]", phase = 3, fname="carbon_price_2030", irange=c(0, 500), iper=2030, sr15 = F)
plot_default(ivar="Price|Carbon", ititle="Carbon Price in 2050 [US$2010/t CO2]", phase = 3, fname="carbon_price_2050", irange=c(0, 1500), sr15 = F)
```

# Climate and Emissions

## Greenhouse Gas Emissions

### CO2

#### Energy {-}
Available historical data sources (2019): BP, CEDS, IEA
```{r}
plot_default(ivar="Emissions|CO2|Energy", ititle="CO2 Energy Emissions in 2030 [GtCO2/yr]", 
             phase = 3, fname="emi_co2_energy_2030", iper=2030, ifac=0.001, histvar = "Emi|CO2|Energy", 
             irange=c(-0.5, 40), sr15=FALSE)
plot_default(ivar="Emissions|CO2|Energy", ititle="CO2 Energy Emissions in 2050 [GtCO2/yr]", 
             phase = 3, fname="emi_co2_energy_2050", irange = c(-5, 10), ifac=0.001, sr15=FALSE)
```

#### Electricity {-}
Available historical data sources (2019): CEDS
```{r}
plot_default(ivar="Emissions|CO2|Energy|Supply|Electricity", ititle="CO2 from Electricity Production in 2030 [GtCO2/yr]", 
             phase = 3, fname="emi_co2_elec_2030", iper=2030, ifac=0.001, sr15=FALSE, irange = c(-4.5, 12),
             histvar = "Emi|CO2|Energy|Supply|Electricity")
plot_default(ivar="Emissions|CO2|Energy|Supply|Electricity", ititle="CO2 from Electricity Production in 2050 [GtCO2/yr]", 
             phase = 3, fname="emi_co2_elec_2050", ifac=0.001, sr15=FALSE, irange = c(-5, 2.5))
```

## Carbon Sequestration
```{r}
# historical data? Emi|CO2|CDR|DACCS + Emi|CO2|CDR|BECCS?
data_ngfs_world_p3 <- data_ngfs_world_p3[!(data_ngfs_world_p3$model == "GCAM" & data_ngfs_world_p3$variable == "Carbon Sequestration|CCS"),]
plot_default(ivar="Carbon Sequestration|CCS", ititle="CCS in 2030 [GtCO2/yr]", 
             phase = 3, fname="CCS_2030", ifac=1e-3, iper=2030, irange = c(0, 3), sr15=FALSE)
plot_default(ivar="Carbon Sequestration|CCS", ititle="CCS in 2050 [GtCO2/yr]", phase = 3, fname="CCS_2050", ifac=1e-3, 
             sr15=FALSE, irange = c(0,15))
```

### Afforestation & BECCS

```{r}
# (=CDR?) Emi|CO2|CDR|BECCS?

# Use of carbon dioxide removal technologies: CO2 emissions captured and stored from bioenergy with
# CCUS (BECCS) and direct air capture in the IPCC scenarios range from 3.5 Gt CO2 to 16 Gt CO2 in 2050,
# compared with 1.9 Gt CO2 in the NZE Scenario.
tmp_sr15 <- data_sr15 %>%
  filter(period == 2030,
         variable %in% c("Carbon Sequestration|CCS|Biomass", "Carbon Sequestration|Land Use|Afforestation"),
         category %in% c("Below 1.5Â°C", "1.5C low overshoot")) %>%
  mutate(value = value*1e-3) %>%
  group_by(model, scenario, region, period) %>%
  summarise(value = sum(value, na.rm=TRUE)) %>%
  ungroup() %>%
  mutate(source = "1 IPCC SR1.5")
tmp_iea <- data.frame(model="IEA WEO 2021 Net2050", scenario = "NZE2050", source="2 IEA", period=2030, value=1.9, region="World", stringsAsFactors = FALSE)
tmp_ngfs <- data_ngfs_world_p3 %>%
  filter(period == 2030,
         scenario %in% u_ngfs_scenario,
         variable %in% c("Carbon Sequestration|CCS|Biomass", "Carbon Sequestration|Land Use|Afforestation"),
         model != "GCAM") %>%
  mutate(value = value*1e-3) %>%
  select(model, scenario, region, variable, period, value) %>%
  group_by(model, scenario, region, period) %>%
  summarise(value = sum(value, na.rm=TRUE)) %>%
  ungroup() %>%
  mutate(source = "3 NGFS")

tmp_ar6 <- data_ar6 %>%
  filter(period == 2030,
         variable %in% c("Carbon Sequestration|CCS|Biomass", "Carbon Sequestration|Land Use|Afforestation"),
         category %in% c("C1")) %>%
  select(model, scenario, region, variable, period, value) %>%
  pivot_wider(names_from = "variable", values_from = "value") %>%
  mutate(variable = "", unit="") %>%
  mutate(source = "2 IPCC AR6") %>%
  mutate(value = (`Carbon Sequestration|CCS|Biomass` + `Carbon Sequestration|Land Use|Afforestation`)*1e-3)
tmp_ar6 <- tmp_ar6 %>% filter(!is.na(value))

tmp_title <- "Carbon dioxide removal (Afforestation & BECCS) \nin 2030 [GtCO2/yr] - Phase 3"

p <- plot_comparison_ar6_ngfs_iea(tmp_sr15, tmp_ngfs, tmp_iea, tmp_ar6, tmp_title, yrange = c(0,3))

plot(p)
ggsave(paste0("plot_CDR_Aff_BECCS_2030_p3_",tmstmp,".png"), p + theme(legend.position = "none"), width = 10, height = 10)


tmp_sr15 <- data_sr15 %>%
  filter(period == 2050,
         variable %in% c("Carbon Sequestration|CCS|Biomass", "Carbon Sequestration|Land Use|Afforestation"),
         category %in% c("Below 1.5Â°C", "1.5C low overshoot")) %>%
  mutate(value = value*1e-3) %>%
  group_by(model, scenario, region, period) %>%
  summarise(value = sum(value, na.rm=TRUE)) %>%
  ungroup() %>%
  mutate(source = "1 IPCC SR1.5")
tmp_iea <- data.frame(model="IEA WEO 2021 Net2050", scenario = "NZE2050", source="2 IEA", period=2050, value=1.9, region="World", stringsAsFactors = FALSE)
tmp_ngfs <- data_ngfs_world_p3 %>%
  filter(period == 2050,
         scenario %in% u_ngfs_scenario,
         variable %in% c("Carbon Sequestration|CCS|Biomass", "Carbon Sequestration|Land Use|Afforestation"),
         model != "GCAM") %>%
  mutate(value = value*1e-3) %>%
  select(model, scenario, region, variable, period, value) %>%
  group_by(model, scenario, region, period) %>%
  summarise(value = sum(value, na.rm=TRUE)) %>%
  ungroup() %>%
  mutate(source = "3 NGFS")

tmp_ar6 <- data_ar6 %>%
  filter(period == 2050,
         variable %in% c("Carbon Sequestration|CCS|Biomass", "Carbon Sequestration|Land Use|Afforestation"),
         category %in% c("C1")) %>%
  select(model, scenario, region, variable, period, value) %>%
  pivot_wider(names_from = "variable", values_from = "value") %>%
  mutate(variable = "", unit="") %>%
  mutate(source = "2 IPCC AR6") %>%
  mutate(value = (`Carbon Sequestration|CCS|Biomass` + `Carbon Sequestration|Land Use|Afforestation`)*1e-3)
tmp_ar6 <- tmp_ar6 %>% filter(!is.na(value))

tmp_title <- "Carbon dioxide removal (Afforestation & BECCS) \nin 2050 [GtCO2/yr] - Phase 3"

p <- plot_comparison_ar6_ngfs_iea(tmp_sr15, tmp_ngfs, tmp_iea, tmp_ar6, tmp_title, yrange = c(0, 12.5))

plot(p)
ggsave(paste0("plot_CDR_Aff_BECCS_2050_p3_",tmstmp,".png"), p + theme(legend.position = "none"), width = 10, height = 10)
```

# Energy

## Primary Energy

```{r}
plot_default(ivar="Primary Energy", ititle="Primary Energy use in 2030 [EJ/yr]", phase = 3, fname="PE_2030", iper=2030, 
             sr15=FALSE, histvar = "PE", irange = c(400, 600))
plot_default(ivar="Primary Energy", ititle="Primary Energy use in 2050 [EJ/yr]", phase = 3, fname="PE_2050", sr15=FALSE,
             irange = c(400,700), histvar = "PE")
```

### Coal {-}
Available historical data sources (2019): BP, IEA
```{r}
plot_default(ivar="Primary Energy|Coal", ititle="Coal Use in 2030 [EJ/yr]", phase = 3, fname="PE_coal_2030", iper=2030, 
             sr15=FALSE, histvar = "PE|Coal", irange = c(0, 180))
plot_default(ivar="Primary Energy|Coal", ititle="Coal Use in 2050 [EJ/yr]", phase = 3, fname="PE_coal_2050", sr15=FALSE,
             irange = c(0,50))
```

### Oil {-}
Available historical data sources (2019): BP, IEA
```{r}
plot_default(ivar="Primary Energy|Oil", ititle="Oil Use in 2030 [EJ/yr]", phase = 3, fname="PE_oil_2030", iper=2030,
             sr15=FALSE, histvar = "PE|Oil", irange = c(90, 220))
plot_default(ivar="Primary Energy|Oil", ititle="Oil Use in 2050 [EJ/yr]", phase = 3, fname="PE_oil_2050", sr15=FALSE,
             irange = c(0, 140))
```

### Gas {-}
Available historical data sources (2019): BP, IEA
```{r}
plot_default(ivar="Primary Energy|Gas", ititle="Gas Use in 2030 [EJ/yr]", phase = 3, fname="PE_gas_2030", iper=2030, 
             sr15=FALSE, histvar = "PE|Gas", irange = c(60, 180))
plot_default(ivar="Primary Energy|Gas", ititle="Gas Use in 2050 [EJ/yr]", phase = 3, fname="PE_gas_2050", sr15=FALSE,
             irange=c(0,155), histvar = "PE|Gas")
```

### Biomass {-}
Available historical data sources (2015): IEA
```{r}
# newer data than 2015 available?
plot_default(ivar="Primary Energy|Biomass", ititle="Primary Bioenergy in 2030 [EJ/yr]", 
             phase = 3, fname="PE_biomass_2030", irange=c(40, 100), iper=2030, sr15=FALSE, histvar = "PE|Biomass", 
             histyear = 2015)
plot_default(ivar="Primary Energy|Biomass", ititle="Primary Bioenergy in 2050 [EJ/yr]", 
             phase = 3, fname="PE_biomass_2050", irange=c(50, 180), sr15=FALSE, histvar = "PE|Biomass", histyear = 2015)
```

## Final Energy
Available historical data sources (2019): IEA
```{r}
plot_default(ivar="Final Energy",ititle="Final Energy Use in 2030 [EJ/yr]", phase = 3, fname="FE_2030", 
             irange=c(330,475), iper=2030, sr15=FALSE, histvar = "FE")
plot_default(ivar="Final Energy",ititle="Final Energy Use in 2050 [EJ/yr]", phase = 3, fname="FE_2050", 
             irange=c(230,600), sr15=FALSE, histvar = "FE")
```


## Electricity Shares Solar/Wind
Available historical data sources (2019, 2021): Ember
```{r}
# historic data from Ember Climate DB: 
# combined share 
# 2019: 8.05 %
# 2021: 10.39 %

tmp_sr15 <- data_sr15 %>%
  filter(period == 2030,
         variable %in% c("Secondary Energy|Electricity", "Secondary Energy|Electricity|Wind", "Secondary Energy|Electricity|Solar"),
         category %in% c("Below 1.5Â°C", "1.5C low overshoot")) %>%
  select(model, scenario, region, variable, period, value) %>%
  pivot_wider(names_from = "variable", values_from = "value") %>%
  mutate(variable = "", unit="") %>%
  mutate(value = 100 * (`Secondary Energy|Electricity|Wind` + `Secondary Energy|Electricity|Solar`) / `Secondary Energy|Electricity`)# IEA data taken from NZE2021_Annex.xlsb > World_Elec > (Solar PV + Wind Ã¼ CSP) / Total generation  * 100
tmp_ar6 <- data_ar6 %>%
  filter(period == 2030,
         variable %in% c("Secondary Energy|Electricity", "Secondary Energy|Electricity|Wind", "Secondary Energy|Electricity|Solar"),
         category %in% c("C1")) %>%
  select(model, scenario, region, variable, period, value) %>%
  pivot_wider(names_from = "variable", values_from = "value") %>%
  mutate(variable = "", unit="") %>%
  mutate(value = 100 * (`Secondary Energy|Electricity|Wind` + `Secondary Energy|Electricity|Solar`) / `Secondary Energy|Electricity`)# IEA data taken from NZE2021_Annex.xlsb > World_Elec > (Solar PV + Wind Ã¼ CSP) / Total generation  * 100
tmp_ar6 <- tmp_ar6 %>% filter(!is.na(value))

tmp_iea <- data_iea_nz %>%
  filter(period == 2030,
         variable %in% c("Secondary Energy|Electricity", "Secondary Energy|Electricity|Wind", "Secondary Energy|Electricity|Solar")) %>%
  select(model, scenario, region, variable, period, value) %>%
  pivot_wider(names_from = "variable", values_from = "value") %>%
  mutate(variable = "", unit="") %>%
  mutate(value = 100 * (`Secondary Energy|Electricity|Wind` + `Secondary Energy|Electricity|Solar`) / `Secondary Energy|Electricity`)

tmp_ngfs <- data_ngfs_world_p3 %>%
  filter(period == 2030,
         variable %in% c("Secondary Energy|Electricity", "Secondary Energy|Electricity|Wind", "Secondary Energy|Electricity|Solar"),
         scenario %in% u_ngfs_scenario) %>%
  select(model, scenario, region, variable, period, value) %>%
  pivot_wider(names_from = "variable", values_from = "value") %>%
  mutate(variable = "", unit="") %>%
  mutate(value = 100 * (`Secondary Energy|Electricity|Wind` + `Secondary Energy|Electricity|Solar`) / `Secondary Energy|Electricity`)
tmp_title <- "Shares of wind and solar in electricity generation in 2030 [%] - Phase 3"

p1 <- plot_comparison_ar6_ngfs_iea(tmp_sr15, tmp_ngfs, tmp_iea, tmp_ar6, tmp_title, yrange = c(0, 80))
# add horizontal lines manually
hist_value <- c(8.05, 10.39)
p1 <- p1 + geom_hline(yintercept=hist_value[1], linetype=2) +
      annotate("text", x= 2030-0.1, y=hist_value[1], label="2019", vjust = 1.5, size = 8)
p1 <- p1 + geom_hline(yintercept=hist_value[2], linetype=2) +
      annotate("text", x= 2030-0.1, y=hist_value[2], label="2021", vjust = -0.5, size = 8)
print(p1)
ggsave(paste0("0_plot_Elec_Share_Solar_Wind_",tmstmp,"_2030_p3_withLegend.png"), p1, width = 12, height = 12)



tmp_sr15 <- data_sr15 %>%
  filter(period == 2050,
         variable %in% c("Secondary Energy|Electricity", "Secondary Energy|Electricity|Wind", "Secondary Energy|Electricity|Solar"),
         category %in% c("Below 1.5Â°C", "1.5C low overshoot")) %>%
  select(model, scenario, region, variable, period, value) %>%
  pivot_wider(names_from = "variable", values_from = "value") %>%
  mutate(variable = "", unit="") %>%
  mutate(value = 100 * (`Secondary Energy|Electricity|Wind` + `Secondary Energy|Electricity|Solar`) / `Secondary Energy|Electricity`)# IEA data taken from NZE2021_Annex.xlsb > World_Elec > (Solar PV + Wind Ã¼ CSP) / Total generation  * 100
tmp_ar6 <- data_ar6 %>%
  filter(period == 2050,
         variable %in% c("Secondary Energy|Electricity", "Secondary Energy|Electricity|Wind", "Secondary Energy|Electricity|Solar"),
         category %in% c("C1")) %>%
  select(model, scenario, region, variable, period, value) %>%
  pivot_wider(names_from = "variable", values_from = "value") %>%
  mutate(variable = "", unit="") %>%
  mutate(value = 100 * (`Secondary Energy|Electricity|Wind` + `Secondary Energy|Electricity|Solar`) / `Secondary Energy|Electricity`)# IEA data taken from NZE2021_Annex.xlsb > World_Elec > (Solar PV + Wind Ã¼ CSP) / Total generation  * 100
tmp_ar6 <- tmp_ar6 %>% filter(!is.na(value))

tmp_iea <- data_iea_nz %>%
  filter(period == 2050,
         variable %in% c("Secondary Energy|Electricity", "Secondary Energy|Electricity|Wind", "Secondary Energy|Electricity|Solar")) %>%
  select(model, scenario, region, variable, period, value) %>%
  pivot_wider(names_from = "variable", values_from = "value") %>%
  mutate(variable = "", unit="") %>%
  mutate(value = 100 * (`Secondary Energy|Electricity|Wind` + `Secondary Energy|Electricity|Solar`) / `Secondary Energy|Electricity`)

tmp_ngfs <- data_ngfs_world_p3 %>%
  filter(period == 2050,
         variable %in% c("Secondary Energy|Electricity", "Secondary Energy|Electricity|Wind", "Secondary Energy|Electricity|Solar"),
         scenario %in% u_ngfs_scenario) %>%
  select(model, scenario, region, variable, period, value) %>%
  pivot_wider(names_from = "variable", values_from = "value") %>%
  mutate(variable = "", unit="") %>%
  mutate(value = 100 * (`Secondary Energy|Electricity|Wind` + `Secondary Energy|Electricity|Solar`) / `Secondary Energy|Electricity`)
tmp_title <- "Shares of wind and solar in electricity generation in 2050 [%] - Phase 3"

p1 <- plot_comparison_ar6_ngfs_iea(tmp_sr15, tmp_ngfs, tmp_iea, tmp_ar6, tmp_title, yrange = c(45, 90))

print(p1)
ggsave(paste0("0_plot_Elec_Share_Solar_Wind_",tmstmp,"_2050_p3_withLegend.png"), p1, width = 12, height = 12)

```
